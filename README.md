# âœï¸ Blue/Green ì‹¤ìŠµìš© ë ˆí¬

ì´ ë ˆí¬ëŠ” Blue/Green ë°°í¬ ì „ëµì„ ì‹¤ìŠµí•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤. Express.jsë¡œ ì‘ì„±ëœ ê°„ë‹¨í•œ í—¬ìŠ¤ì²´í¬ APIì™€ Nginxë¥¼ ì‚¬ìš©í•˜ì—¬ Blue/Green ë°°í¬ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

## ğŸš§ ë¬¸ì œ ìƒí™©1

- amd64 í™˜ê²½ì—ì„œë§Œ ë™ì‘í•˜ëŠ” Docker ì´ë¯¸ì§€ë¥¼ ARM64 í™˜ê²½ì—ì„œ ì‹¤í–‰í•˜ë ¤ê³  í•  ë•Œ í˜¸í™˜ì„± ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.

## ğŸ› ï¸ í•´ê²° ë°©ë²•1

- QEMUë¥¼ ì‚¬ìš©í•˜ì—¬ ARM64 ì—ë®¬ë ˆì´ì…˜ì„ ì„¤ì •í•©ë‹ˆë‹¤.
- Docker Buildxë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ì¤‘ ì•„í‚¤í…ì²˜ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  í‘¸ì‹œí•©ë‹ˆë‹¤.
- GitHub Actions ì›Œí¬í”Œë¡œìš°ë¥¼ ìˆ˜ì •í•˜ì—¬ ARM64 í™˜ê²½ì—ì„œë„ ë¹Œë“œ ë° ë°°í¬ê°€ ê°€ëŠ¥í•˜ë„ë¡ í•©ë‹ˆë‹¤.

## ğŸš§ ë¬¸ì œ ìƒí™©2

- QEMU, Buildxë¥¼ ì‚¬ìš©í•˜ì—¬ multi-arch ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ëŠ” ê²½ìš°, ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— amd64ì™€ arm64 ì´ë¯¸ì§€ê°€ ê°ê° ì €ì¥ë©ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ì €ì¥ì†Œ ìš©ëŸ‰ì´ ë‘ ë°°ë¡œ ì¦ê°€í•˜ëŠ” ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ› ï¸ í•´ê²° ë°©ë²•2

- ë¹Œë“œ ì‹œ `--platform` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì•„í‚¤í…ì²˜(ì˜ˆ: linux/arm64)ë§Œ ë¹Œë“œí•˜ê³  í‘¸ì‹œí•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.

## ğŸš§ ë¬¸ì œ ìƒí™©3

- Docker ì´ë¯¸ì§€ê°€ ë„ˆë¬´ ì»¤ì„œ ì¶”í›„ ECRì— í‘¸ì‹œí•  ë•Œ Cost ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ› ï¸ í•´ê²° ë°©ë²•3

- ë” ì‘ì€ ë² ì´ìŠ¤ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ Docker ì´ë¯¸ì§€ ê²½ëŸ‰í™”
- Container ë‚´ë¶€ Health Check -> Host Health Checkë¡œ ë³€ê²½
- Docker Image 1.72GB -> 327MB

  ![Before](./docs/assets/images/problem-3/before.png)

  ![After](./docs/assets/images/problem-3/after.png)

## ğŸ“„ GitHub Actions ì›Œí¬í”Œë¡œìš° ì¶”ê°€ ìˆ˜ì • ì‚¬í•­

- `paths-ignore` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ `./docs/**`, `**.md` ê²½ë¡œì˜ íŒŒì¼ ë³€ê²½ ì‹œ ì›Œí¬í”Œë¡œìš°ê°€ ì‹¤í–‰ë˜ì§€ ì•Šë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.
